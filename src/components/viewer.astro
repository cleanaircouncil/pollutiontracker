---
const { attachment = {} } = Astro.props;
---

<section id="viewer" class="viewer | lightbox" data-viewer hidden>
  <header class="layout-spread">
    <div>
      <strong>{attachment.filename}</strong>
    </div>

    <div class="layout-row gap">
      <a href={attachment.url} download={attachment.filename}>
        <i class="fa fa-download"></i> Download PDF
      </a>

      <button data-close>
        <i class="fa fa-close"></i>
      </button>
    </div>
  </header>

  <iframe src={attachment.url}>Loading...</iframe>
</section>

<style>
  .lightbox {
    margin: 0px;
    inset: 0px;
    width: 100%;
    height: 100%;
    position: absolute;
    z-index: 100;
    background: rgba(0, 0, 0, 0.8);
  }

  .viewer[hidden] {
    display: none;
  }

  .viewer {
    color: var(--color-white);
    padding: 1rem;
    display: grid;
    grid-template-rows: min-content 1fr;
    gap: 1rem;
    grid-template-areas:
      "header"
      "viewer";
  }

  .viewer a,
  .viewer button {
    color: inherit;
    background: none;
    border: none;
    text-decoration: none;
    line-height: 1.5rem;
    cursor: pointer;
  }

  .viewer iframe {
    border: none;
    width: 100%;
    height: 100%;
    border-radius: 1rem;
  }
</style>

<script>
  import { dispatch } from "../helpers/events";

  const buttonEl = document.querySelector("[data-viewer] [data-close]");
  buttonEl.addEventListener("click", () =>
    dispatch("lightbox", { attachment: null })
  );
</script>
